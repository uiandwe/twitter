{"ts":1363310415545,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1363310426600,"patch":[[{"diffs":[[1,"var request = require('request')\r\n    , JSONStream = require('JSONStream')\r\n    , es = require('event-stream')\r\n    , async = require('async') \r\n    , socketio = require('socket.io')\r\n    , express = require('express');\r\n\r\n \r\n    var app = express();\r\n    var server = require('http').createServer(app);\r\n    var io = socketio.listen(server);\r\n    \r\n    app.get('/', function(req, res){\r\n        //console.log(\"WORKED!! %s\", process.env.NODE_WORKER_ID);\r\n        res.sendfile('index.html');\r\n    });\r\n \r\n   \r\n    console.log('Server Running~!');\r\n        \r\n    function thread1() { \r\n        var result  = Array();\r\nvar result_twi  = Array();\r\n     \r\n        var parser = JSONStream.parse(['results', true])\r\n                     .on('error', function(err) { console.log(err); })\r\n          , req = request({url: 'http://search.twitter.com/search.json?geocode=37.335887,126.584063,125000km'})\r\n          , logger = es.mapSync(function (data) {\r\n                //console.log(data.iso_language_code);\r\n                result.push(data.iso_language_code);\r\n        result_twi.push(data.text);\r\n             \r\n        }).on('error', function(err) { console.log(err); });\r\n        \r\n        \r\n        async.parallel([\r\n          function(callback) {\r\n            setTimeout(function() {\r\n              req.pipe(parser).pipe(logger);\r\n              callback(null, 'one');   \r\n            }, 10);\r\n          },\r\n        \r\n           \r\n          function(callback) {          \r\n            setTimeout(function(){\r\n              callback(null, 'three');\r\n            }, 1000);\r\n          },\r\n        ],\r\n        \r\n        function(err, results) {\r\n            //console.log('twitter count : '+result.length);\r\n            //io.sockets.on('connection', function (socket) {\r\n             // console.log(\"return : \" + result.length);\r\n             io.sockets.emit('message', result); \r\n             io.sockets.emit('message_twi', result_twi); \r\n           // });\r\n        });\r\n    }\r\n\r\n    var tid = setInterval( thread1,  1500);\r\n    \r\n    server.listen(8080);\r\n\r\n\r\n"]],"start1":0,"start2":0,"length1":0,"length2":2056}]],"length":2056,"saved":false}
{"ts":1363310445837,"patch":[[{"diffs":[[0,"){\r\n"],[-1,"        //console.log(\"WORKED!! %s\", process.env.NODE_WORKER_ID);\r\n"],[0,"    "]],"start1":384,"start2":384,"length1":75,"length2":8},{"diffs":[[0," {\r\n"],[-1,"            //console.log('twitter count : '+result.length);\r\n            //io.sockets.on('connection', function (socket) {\r\n             // console.log(\"return : \" + result.length);\r\n"],[0,"    "]],"start1":1569,"start2":1569,"length1":192,"length2":8},{"diffs":[[0,"; \r\n"],[-1,"           // });\r\n"],[0,"    "]],"start1":1679,"start2":1679,"length1":27,"length2":8}]],"length":1786,"saved":false}
{"ts":1363310478914,"patch":[[{"diffs":[[0,"ray();\r\n"],[1,"        "],[0,"var resu"]],"start1":541,"start2":541,"length1":16,"length2":24}]],"length":1794,"saved":false}
{"ts":1363310783182,"patch":[[{"diffs":[[0,"ay();\r\n     "],[1,"   \r\n        //json 파서"],[0,"\r\n"],[-1,""],[0,"        var "]],"start1":578,"start2":578,"length1":26,"length2":48},{"diffs":[[0,"g(err); })\r\n"],[1,"            //트위터 쿼리문(한국에서 반경 125000km 까지의 트위터 검색)        \r\n"],[0,"          , "]],"start1":732,"start2":732,"length1":24,"length2":84},{"diffs":[[0,"anguage_code);\r\n"],[1,"                //파싱한 데이터를 배열에 넣음\r\n"],[0,"                "]],"start1":1008,"start2":1008,"length1":32,"length2":67},{"diffs":[[0,"anguage_code);\r\n"],[1,"        "],[0,"        result_t"]],"start1":1097,"start2":1097,"length1":32,"length2":40},{"diffs":[[0,");\r\n"],[-1,"             \r\n"],[0,"    "]],"start1":1154,"start2":1154,"length1":23,"length2":8},{"diffs":[[0,"      \r\n        "],[1,"//json 비동기 처리를 위한 패러럴모듈사용"],[0,"\r\n        async."]],"start1":1222,"start2":1222,"length1":32,"length2":57},{"diffs":[[0,"  ],\r\n        \r\n"],[1,"        //html 로 메시지 보냄\r\n"],[0,"        function"]],"start1":1666,"start2":1666,"length1":32,"length2":57},{"diffs":[[0,"   }\r\n\r\n"],[1,"    //1.5초마다 스레드함수로 시작\r\n"],[0,"    var "]],"start1":1865,"start2":1865,"length1":16,"length2":40},{"diffs":[[0,"00);\r\n    \r\n"],[1,"    \r\n"],[0,"    server.l"]],"start1":1936,"start2":1936,"length1":24,"length2":30}]],"length":1984,"saved":false}
